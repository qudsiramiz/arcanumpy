

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>arcanum.histogram_plots &mdash; ArcanumPy  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=004ebab9" />

  
    <link rel="shortcut icon" href="../../_static/arcanumpy_logo.png"/>
    <link rel="canonical" href="https://qudsiramiz.space/arcanumpy/_modules/arcanum/histogram_plots.html" />
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/thebelab-helper.js"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #042444" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ArcanumPy
              <img src="../../_static/arcanumpy_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About ArcanumPy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../citation.html">Citation and Acknowledgements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../citation.html#contributors">Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../citation.html#citation">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../citation.html#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.SeabornFig2Grid.html">arcanum.SeabornFig2Grid</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.SeabornFig2Grid.html#arcanum.SeabornFig2Grid.SeabornFig2Grid"><code class="docutils literal notranslate"><span class="pre">SeabornFig2Grid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.SeabornFig2Grid.html#arcanum.SeabornFig2Grid.SeabornFig2Grid.__init__"><code class="docutils literal notranslate"><span class="pre">SeabornFig2Grid.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.SeabornFig2Grid.html#arcanum.SeabornFig2Grid.SeabornFig2Grid.__dict__"><code class="docutils literal notranslate"><span class="pre">SeabornFig2Grid.__dict__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.SeabornFig2Grid.html#arcanum.SeabornFig2Grid.SeabornFig2Grid.__module__"><code class="docutils literal notranslate"><span class="pre">SeabornFig2Grid.__module__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.arcanum.html">arcanum.arcanum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html">arcanum.get_files_from_web</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html#arcanum.get_files_from_web.get_files_from_web"><code class="docutils literal notranslate"><span class="pre">get_files_from_web</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html#arcanum.get_files_from_web.get_files_from_web.download_files_from_cdaweb"><code class="docutils literal notranslate"><span class="pre">get_files_from_web.download_files_from_cdaweb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html#arcanum.get_files_from_web.get_files_from_web.__init__"><code class="docutils literal notranslate"><span class="pre">get_files_from_web.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html#id0"><code class="docutils literal notranslate"><span class="pre">get_files_from_web.download_files_from_cdaweb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html#arcanum.get_files_from_web.get_files_from_web.__dict__"><code class="docutils literal notranslate"><span class="pre">get_files_from_web.__dict__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html#arcanum.get_files_from_web.get_files_from_web.__module__"><code class="docutils literal notranslate"><span class="pre">get_files_from_web.__module__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.hist_test.html">arcanum.hist_test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html">arcanum.histogram_plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots"><code class="docutils literal notranslate"><span class="pre">hist_plots</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.__init__"><code class="docutils literal notranslate"><span class="pre">hist_plots.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.compute_rr"><code class="docutils literal notranslate"><span class="pre">hist_plots.compute_rr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.get_thresh"><code class="docutils literal notranslate"><span class="pre">hist_plots.get_thresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.brazil_plot_with_threshold"><code class="docutils literal notranslate"><span class="pre">hist_plots.brazil_plot_with_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.get_brzl_hist"><code class="docutils literal notranslate"><span class="pre">hist_plots.get_brzl_hist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.brazil_plot_multiple"><code class="docutils literal notranslate"><span class="pre">hist_plots.brazil_plot_multiple()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.calc_pdf"><code class="docutils literal notranslate"><span class="pre">hist_plots.calc_pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.joint_pdf"><code class="docutils literal notranslate"><span class="pre">hist_plots.joint_pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.kde_plots"><code class="docutils literal notranslate"><span class="pre">hist_plots.kde_plots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.__dict__"><code class="docutils literal notranslate"><span class="pre">hist_plots.__dict__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.__module__"><code class="docutils literal notranslate"><span class="pre">hist_plots.__module__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.html">arcanum</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.SeabornFig2Grid.html">arcanum.SeabornFig2Grid module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.arcanum.html">arcanum.arcanum module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.get_files_from_web.html">arcanum.get_files_from_web module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.hist_test.html">arcanum.hist_test module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.histogram_plots.html">arcanum.histogram_plots module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.seaborn_plots.html">arcanum.seaborn_plots module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.seaborn_plots_fncs.html">arcanum.seaborn_plots_fncs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html">arcanum.text_color_fnc module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.html#module-arcanum">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.seaborn_plots.html">arcanum.seaborn_plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.seaborn_plots_fncs.html">arcanum.seaborn_plots_fncs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.seaborn_plots_fncs.html#arcanum.seaborn_plots_fncs.kde_plots"><code class="docutils literal notranslate"><span class="pre">kde_plots()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.seaborn_plots_fncs.html#arcanum.seaborn_plots_fncs.seaborn_subplots"><code class="docutils literal notranslate"><span class="pre">seaborn_subplots()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html">arcanum.text_color_fnc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color"><code class="docutils literal notranslate"><span class="pre">text_color</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.red_text"><code class="docutils literal notranslate"><span class="pre">text_color.red_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.green_text"><code class="docutils literal notranslate"><span class="pre">text_color.green_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.yellow_text"><code class="docutils literal notranslate"><span class="pre">text_color.yellow_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.blue_text"><code class="docutils literal notranslate"><span class="pre">text_color.blue_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.magenta_text"><code class="docutils literal notranslate"><span class="pre">text_color.magenta_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.cyan_text"><code class="docutils literal notranslate"><span class="pre">text_color.cyan_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.white_text"><code class="docutils literal notranslate"><span class="pre">text_color.white_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.black_text"><code class="docutils literal notranslate"><span class="pre">text_color.black_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.aqua_text"><code class="docutils literal notranslate"><span class="pre">text_color.aqua_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.orange_text"><code class="docutils literal notranslate"><span class="pre">text_color.orange_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.purple_text"><code class="docutils literal notranslate"><span class="pre">text_color.purple_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.pink_text"><code class="docutils literal notranslate"><span class="pre">text_color.pink_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.grey_text"><code class="docutils literal notranslate"><span class="pre">text_color.grey_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.brown_text"><code class="docutils literal notranslate"><span class="pre">text_color.brown_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.turquoise_text"><code class="docutils literal notranslate"><span class="pre">text_color.turquoise_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.lime_text"><code class="docutils literal notranslate"><span class="pre">text_color.lime_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.bold_text"><code class="docutils literal notranslate"><span class="pre">text_color.bold_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.underline_text"><code class="docutils literal notranslate"><span class="pre">text_color.underline_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.blink_text"><code class="docutils literal notranslate"><span class="pre">text_color.blink_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.reverse_text"><code class="docutils literal notranslate"><span class="pre">text_color.reverse_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.invisible_text"><code class="docutils literal notranslate"><span class="pre">text_color.invisible_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.strikethrough_text"><code class="docutils literal notranslate"><span class="pre">text_color.strikethrough_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.double_underline_text"><code class="docutils literal notranslate"><span class="pre">text_color.double_underline_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.double_intensity_text"><code class="docutils literal notranslate"><span class="pre">text_color.double_intensity_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.__dict__"><code class="docutils literal notranslate"><span class="pre">text_color.__dict__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.text_color.__module__"><code class="docutils literal notranslate"><span class="pre">text_color.__module__</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color"><code class="docutils literal notranslate"><span class="pre">background_color</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.red_background"><code class="docutils literal notranslate"><span class="pre">background_color.red_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.green_background"><code class="docutils literal notranslate"><span class="pre">background_color.green_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.yellow_background"><code class="docutils literal notranslate"><span class="pre">background_color.yellow_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.blue_background"><code class="docutils literal notranslate"><span class="pre">background_color.blue_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.magenta_background"><code class="docutils literal notranslate"><span class="pre">background_color.magenta_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.cyan_background"><code class="docutils literal notranslate"><span class="pre">background_color.cyan_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.white_background"><code class="docutils literal notranslate"><span class="pre">background_color.white_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.black_background"><code class="docutils literal notranslate"><span class="pre">background_color.black_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.aqua_background"><code class="docutils literal notranslate"><span class="pre">background_color.aqua_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.orange_background"><code class="docutils literal notranslate"><span class="pre">background_color.orange_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.purple_background"><code class="docutils literal notranslate"><span class="pre">background_color.purple_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.pink_background"><code class="docutils literal notranslate"><span class="pre">background_color.pink_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.grey_background"><code class="docutils literal notranslate"><span class="pre">background_color.grey_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.brown_background"><code class="docutils literal notranslate"><span class="pre">background_color.brown_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.turquoise_background"><code class="docutils literal notranslate"><span class="pre">background_color.turquoise_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.lime_background"><code class="docutils literal notranslate"><span class="pre">background_color.lime_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.bold_background"><code class="docutils literal notranslate"><span class="pre">background_color.bold_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.underline_background"><code class="docutils literal notranslate"><span class="pre">background_color.underline_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.blink_background"><code class="docutils literal notranslate"><span class="pre">background_color.blink_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.reverse_background"><code class="docutils literal notranslate"><span class="pre">background_color.reverse_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.invisible_background"><code class="docutils literal notranslate"><span class="pre">background_color.invisible_background()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.__dict__"><code class="docutils literal notranslate"><span class="pre">background_color.__dict__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.text_color_fnc.html#arcanum.text_color_fnc.background_color.__module__"><code class="docutils literal notranslate"><span class="pre">background_color.__module__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_files/modules.html">modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_files/arcanum.html">arcanum package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rst_files/arcanum.html#module-arcanum">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #042444" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ArcanumPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">arcanum.histogram_plots</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for arcanum.histogram_plots</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.axes_grid1</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>


<div class="viewcode-block" id="hist_plots">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">hist_plots</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to plot histograms and brazil plots for the given data and thresholds respectively.</span>
<span class="sd">    It also contains a method to calculate the probability density function of a given array.</span>
<span class="sd">    Name of the functions contain the following:</span>
<span class="sd">    - calc_pdf: calculates the probability density function of a given array</span>
<span class="sd">    - joint_pdf: calculates the joint probability density function of two given arrays</span>
<span class="sd">    - brazil_plot_with_threshold: plots the brazil plot for the given data with thresholds</span>
<span class="sd">    - get_thresh: gets the threshold values for the given data</span>
<span class="sd">    - compute_rr: computes the threshold values for the given data</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="hist_plots.__init__">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="hist_plots.compute_rr">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.compute_rr">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_rr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">instab</span><span class="o">=</span><span class="s2">&quot;cycl&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Threshold calculation based on Verscharen and Chandran 2018</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">instab</span> <span class="o">==</span> <span class="s2">&quot;cycl&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">0.649</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.400</span>
                <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">0.437</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.428</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.003</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">0.367</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.364</span>
                <span class="n">c</span> <span class="o">=</span> <span class="mf">0.011</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Only values of $\gamma/\Omega$ = -2, -3 and -4 are supported&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">instab</span> <span class="o">==</span> <span class="s2">&quot;mirr&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">1.040</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.633</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.012</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">0.801</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.763</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.063</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">0.702</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.674</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.009</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Only values of $\gamma/\Omega$ = -2, -3 and -4 are supported&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">instab</span> <span class="o">==</span> <span class="s2">&quot;fir1&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.647</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.583</span>
                <span class="n">c</span> <span class="o">=</span> <span class="mf">0.713</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.497</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.566</span>
                <span class="n">c</span> <span class="o">=</span> <span class="mf">0.543</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.408</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">0.529</span>
                <span class="n">c</span> <span class="o">=</span> <span class="mf">0.410</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Only values of $\gamma/\Omega$ = -2, -3 and -4 are supported&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">instab</span> <span class="o">==</span> <span class="s2">&quot;fir2&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.447</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">1.000</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.148</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.390</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">1.005</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.111</span>
            <span class="k">elif</span> <span class="n">gamma</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.454</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mf">1.023</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.178</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Only values of $\gamma/\Omega$ = -2, -3 and -4 are supported&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="o">/</span> <span class="p">((</span><span class="n">bb</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="hist_plots.get_thresh">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.get_thresh">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_thresh</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">instab</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parnt_drct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="s2">&quot;hi-res&quot;</span>
    <span class="p">):</span>

        <span class="c1"># Open the appropriate data files for the requested instability.  If a</span>
        <span class="c1"># valid instability was not specified, abort.</span>

        <span class="k">if</span> <span class="n">parnt_drct</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parnt_drct</span> <span class="o">=</span> <span class="s2">&quot;../.arcanum_data/linear_instability_data/protn&quot;</span>
            <span class="c1"># Expand the user</span>
            <span class="n">parnt_drct</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">parnt_drct</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">instab</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fir1&quot;</span><span class="p">,</span> <span class="s2">&quot;fir2&quot;</span><span class="p">]:</span>
            <span class="n">ohalf</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">instab</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cycl&quot;</span><span class="p">,</span> <span class="s2">&quot;mirr&quot;</span><span class="p">]:</span>
            <span class="n">ohalf</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="k">if</span> <span class="n">drct</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">instab</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mirr&quot;</span><span class="p">,</span> <span class="s2">&quot;fir2&quot;</span><span class="p">]:</span>
                <span class="n">drct</span> <span class="o">=</span> <span class="s2">&quot;0.001_4.000_0.000&quot;</span>
            <span class="k">elif</span> <span class="n">instab</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cycl&quot;</span><span class="p">,</span> <span class="s2">&quot;fir1&quot;</span><span class="p">]:</span>
                <span class="n">drct</span> <span class="o">=</span> <span class="s2">&quot;0.001_4.000_0.000_00.00&quot;</span>

        <span class="k">if</span> <span class="n">instab</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mirr&quot;</span><span class="p">,</span> <span class="s2">&quot;fir2&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">res</span> <span class="o">==</span> <span class="s2">&quot;lo-res&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">instab</span> <span class="o">==</span> <span class="s2">&quot;fir2&quot;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;hi-res&quot;</span>
            <span class="n">new_drct</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;.arcanum_data/linear_instability_data/protn/</span><span class="si">{</span><span class="n">instab</span><span class="si">}</span><span class="s2">/0.001_4.000_0.000/</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">/&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_drct</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parnt_drct</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">instab</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">drct</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">/&quot;</span>

        <span class="n">fl_b</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">new_drct</span> <span class="o">+</span> <span class="s2">&quot;out_bj.dat&quot;</span><span class="p">)</span>
        <span class="n">fl_r</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">new_drct</span> <span class="o">+</span> <span class="s2">&quot;out_ri.dat&quot;</span><span class="p">)</span>
        <span class="n">fl_g</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">new_drct</span> <span class="o">+</span> <span class="s2">&quot;out_gij.dat&quot;</span><span class="p">)</span>

        <span class="c1"># Extract the values in the files.</span>

        <span class="n">arr_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fl_b</span><span class="p">])</span>
        <span class="n">arr_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fl_r</span><span class="p">])</span>
        <span class="n">arr_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fl_g</span><span class="p">])</span>

        <span class="p">(</span><span class="n">n_r</span><span class="p">,</span> <span class="n">n_b</span><span class="p">)</span> <span class="o">=</span> <span class="n">arr_g</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># If requested, print out the shape of the arrays.</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">arr_b</span><span class="p">,</span> <span class="n">arr_r</span><span class="p">,</span> <span class="n">arr_g</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># Initialize the threshold arrays.</span>

        <span class="n">crv_b</span> <span class="o">=</span> <span class="n">arr_b</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">crv_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">crv_b</span><span class="p">)</span>

        <span class="c1"># Extract the requested threshold level. For each beta-value, use</span>
        <span class="c1"># interpolation to estimate the anisotropy-value that has a gamma</span>
        <span class="c1"># value closest to the target &quot;gamma&quot;.</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_b</span><span class="p">):</span>

            <span class="c1"># If the target value &quot;gamma&quot; does not fall into the range of</span>
            <span class="c1"># gamma-values returned for this beta-value, skip to the next</span>
            <span class="c1"># beta-value.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">arr_g</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">gamma</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">arr_g</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">gamma</span><span class="p">):</span>

                <span class="k">continue</span>

            <span class="c1"># Search through the anisotropy-values (beginning with R = 1)</span>
            <span class="c1"># until one is found with a gamma-value less than the target</span>
            <span class="c1"># &quot;gamma&quot; and that is followed by an anisotropy-value with a</span>
            <span class="c1"># gamma-value greater than the target &quot;gamma&quot;.</span>

            <span class="c1"># NOTE: The &quot;for&quot;-statement immediately below may seem a bit</span>
            <span class="c1">#        odd, but it does work.  The &quot;[::ohalf]&quot; ensures that</span>
            <span class="c1">#        the loop begins with R = 1 and moves outward.  The</span>
            <span class="c1">#        &quot;[:-1]&quot; remove supresses the final anisotropy value.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_r</span><span class="p">)[::</span><span class="n">ohalf</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

                <span class="c1"># If the gamma-value of the current anisotropy-value is</span>
                <span class="c1"># less than the target &quot;gamma&quot; and the gamma-value of</span>
                <span class="c1"># the next anisotropy-value is greater than the target</span>
                <span class="c1"># &quot;gamma&quot;, interpolate between them.</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">arr_g</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">arr_g</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">gamma</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">arr_g</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ohalf</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">gamma</span><span class="p">)</span>
                <span class="p">):</span>

                    <span class="c1"># Extract the bounding anisotropy-values and the</span>
                    <span class="c1"># logs of their corresponding gamma-values.</span>
                    <span class="n">r1</span> <span class="o">=</span> <span class="n">arr_r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                    <span class="n">r2</span> <span class="o">=</span> <span class="n">arr_r</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ohalf</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

                    <span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">arr_g</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
                    <span class="n">l2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">arr_g</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ohalf</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

                    <span class="c1"># Store the interpolated value to the threshold</span>
                    <span class="c1"># array.</span>
                    <span class="n">crv_r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">-</span> <span class="n">l1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">l2</span> <span class="o">-</span> <span class="n">l1</span><span class="p">))</span> <span class="o">+</span> <span class="n">r1</span>

                    <span class="c1"># If requested, print out the interpolation</span>
                    <span class="c1"># values.</span>
                    <span class="c1"># Move on to the next beta-value.</span>

                    <span class="k">break</span>

        <span class="c1"># Remove elements from the threshold arrays corresponding to beta-values</span>
        <span class="c1"># for which no anisotropy-value could be found.</span>

        <span class="n">tk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">crv_r</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">crv_b</span> <span class="o">=</span> <span class="n">crv_b</span><span class="p">[</span><span class="n">tk</span><span class="p">]</span>
        <span class="n">crv_r</span> <span class="o">=</span> <span class="n">crv_r</span><span class="p">[</span><span class="n">tk</span><span class="p">]</span>

        <span class="c1">#    print min(crv_b), max( crv_b), min(crv_r), max(crv_r)</span>
        <span class="c1"># Return the threshold arrays.</span>

        <span class="k">return</span> <span class="n">crv_b</span><span class="p">,</span> <span class="n">crv_r</span></div>


<div class="viewcode-block" id="hist_plots.brazil_plot_with_threshold">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.brazil_plot_with_threshold">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">brazil_plot_with_threshold</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">rp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">xmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">xmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ymin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ymax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bins</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">nbins</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">g_lim_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">g_lim_2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">g_lim_3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">g_lim_4</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">dir_par</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">dir_per</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">res</span><span class="o">=</span><span class="s2">&quot;hi-res&quot;</span><span class="p">,</span>
        <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">sim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_thresh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_ver_thresh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">save_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">plot_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">pcolormesh_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The code to plot the brazil plot for any kind of data. The scale of both x- and y-axes is</span>
<span class="sd">        &quot;log&quot;, this can be changed in the line which 65 or so where &quot;bins&quot; is defined and setting</span>
<span class="sd">        both scales of x- and y-axes to linear instead of log.</span>

<span class="sd">        bp : ion parallel beta (type:array)</span>
<span class="sd">        rp : ion anisotropy (type:array)</span>
<span class="sd">        xmin : minimum value of x-axis (type:float)</span>
<span class="sd">        xmax : maximum value of x-axis (type:float)</span>
<span class="sd">        ymin : minimum value of y-axis (type:float)</span>
<span class="sd">        ymax : maximum value of y-axis (type:float)</span>
<span class="sd">        bins : x and y bins (type:array)</span>
<span class="sd">        nbins : number of bins in each direction, defaults to 50 (type:float)</span>
<span class="sd">        cmin : minimum value in a bin to be plotted, defaults to 10 (type:float)</span>
<span class="sd">        vmin : minimum value of colorbar</span>
<span class="sd">        vmax : maximum value fo colorbar</span>
<span class="sd">        g_lim_1 to 4 : value of instability thresholds to be plotted</span>
<span class="sd">            1 =&gt; cyclotron instability</span>
<span class="sd">            2 =&gt; parallel firehose instability</span>
<span class="sd">            3 =&gt; mirror instability</span>
<span class="sd">            4 =&gt; oblique firehose instability</span>
<span class="sd">        dir_par : directory for parallel instabilities</span>
<span class="sd">        dir_per : directory for oblique instabilities</span>
<span class="sd">        res : resolution of thresholds to be plotted, defaults to &quot;hi-res&quot;, other option is &quot;lo-res&quot;</span>
<span class="sd">        loc : location of legend</span>
<span class="sd">        sim : type of data, this is used while saving figure</span>
<span class="sd">        density : whether to plot probabilty density or somple histogram, defaults to false</span>
<span class="sd">        plot_thresh : whether to plot thresholds, defaults to false</span>
<span class="sd">        save_fig : to save the figure or not, defaults to true</span>
<span class="sd">        plot_show : display the plot, defaults to false</span>
<span class="sd">        pcolormesh_kwargs : additional arguments to be passed to pcolormesh</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ex : x-axis bins</span>
<span class="sd">        ey : y-axis bins</span>
<span class="sd">        hist : histogram of the data</span>
<span class="sd">        n_hist : normalized histogram of the data</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from arcanum.histogram_plots import hist_plots</span>
<span class="sd">        &gt;&gt;&gt; bp = np.random.lognormal(mean=0, sigma=2, size=10000)</span>
<span class="sd">        &gt;&gt;&gt; bp = np.clip(bp, 1e-3, 1e2)</span>
<span class="sd">        &gt;&gt;&gt; rp = np.random.lognormal(mean=0, sigma=2, size=10000)</span>
<span class="sd">        &gt;&gt;&gt; rp = np.clip(rp, 1e-1, 1e1)</span>
<span class="sd">        &gt;&gt;&gt; ex, ey, hist, n_hist = hist_plots().brazil_plot_with_threshold(bp=bp, rp=rp, xmin=1e-3, xmax=1e2, ymin=1e-1, ymax=1e1, cmin=0, g_lim_1=2, g_lim_2=2, g_lim_3=2, g_lim_4=2, nbins=100, dir_par=&quot;0.001_4.000_0.000_00.00&quot;, dir_per=&quot;0.001_4.000_0.000&quot;, res=&quot;hi-res&quot;, loc=1, plot_thresh=True, plot_ver_thresh=False, save_fig=True, sim=&quot;wnd&quot;, plot_show=False, density=True, pcolormesh_kwargs={&quot;norm&quot;: &quot;log&quot;, &quot;cmap&quot;: &quot;cividis_r&quot;})</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Define all the default values</span>
        <span class="n">clabelpad</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">labelsize</span> <span class="o">=</span> <span class="mi">18</span>
        <span class="n">ticklabelsize</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">clabelsize</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">ticklength</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">tickwidth</span> <span class="o">=</span> <span class="mf">1.5</span>
        <span class="n">ticklength</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">mticklength</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">cticklength</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">mcticklength</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">labelrotation</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Extract the data</span>
        <span class="c1"># Anisotropy</span>
        <span class="n">rp_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>

        <span class="c1"># Beta values</span>
        <span class="n">bp_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nbins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbins</span> <span class="o">=</span> <span class="mi">50</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">bp_arr</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">bp_arr</span><span class="p">)),</span> <span class="n">nbins</span>
                <span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">rp_arr</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">rp_arr</span><span class="p">)),</span> <span class="n">nbins</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">cmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmin</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="c1"># Get the 2D histogram</span>
        <span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">bp_arr</span><span class="p">,</span> <span class="n">rp_arr</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

        <span class="c1"># Set all the bins with less than cmin to nan</span>
        <span class="n">hist</span><span class="p">[</span><span class="n">hist</span> <span class="o">&lt;</span> <span class="n">cmin</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">if</span> <span class="n">density</span><span class="p">:</span>
            <span class="n">n_hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">hist</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">yy</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">db</span> <span class="o">=</span> <span class="n">ex</span><span class="p">[</span><span class="n">xx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ex</span><span class="p">[</span><span class="n">xx</span><span class="p">]</span>
                    <span class="n">dr</span> <span class="o">=</span> <span class="n">ey</span><span class="p">[</span><span class="n">yy</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ey</span><span class="p">[</span><span class="n">yy</span><span class="p">]</span>
                    <span class="n">n_hist</span><span class="p">[</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">]</span> <span class="o">=</span> <span class="n">hist</span><span class="p">[</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">db</span> <span class="o">*</span> <span class="n">dr</span><span class="p">)</span>
            <span class="n">hist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_hist</span> <span class="o">=</span> <span class="n">hist</span>

        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">[</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">]:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">n_hist</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">n_hist</span><span class="p">)</span>

        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">ex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">ex</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">ey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">ey</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Define the figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
            <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="c1"># Define the axes in the figure</span>
        <span class="n">axs1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">im1</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">ex</span><span class="p">,</span>
            <span class="n">ey</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">n_hist</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
            <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
            <span class="c1"># cmap=cmap,</span>
            <span class="c1"># norm=norm,</span>
            <span class="o">**</span><span class="p">(</span><span class="n">pcolormesh_kwargs</span> <span class="k">if</span> <span class="n">pcolormesh_kwargs</span> <span class="k">else</span> <span class="p">{}),</span>
        <span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">im1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">im1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">mticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs_xlabel</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$\beta_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">} = 2 \mu_0 n_\mathrm</span><span class="si">{p}</span><span class="s2"> k_\mathrm</span><span class="si">{B}</span><span class="s2">$&quot;</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$T_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">}/B^2$&quot;</span>
        <span class="p">)</span>

        <span class="n">axs_ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$R_{\mathrm</span><span class="si">{p}</span><span class="s2">} = T_{\perp \mathrm</span><span class="si">{p}</span><span class="s2">}/T_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">}$&quot;</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axs_xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">axs_ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

        <span class="c1"># Create a new axis for colorbar</span>
        <span class="n">divider1</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs1</span><span class="p">)</span>

        <span class="c1"># Define the location of the colorbar, it&quot;s size relative to main figure and the padding</span>
        <span class="c1"># between the colorbar and the figure, the orientation the colorbar</span>
        <span class="n">cax1</span> <span class="o">=</span> <span class="n">divider1</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">cbar1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">im1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span>
        <span class="p">)</span>

        <span class="c1"># Define the parameters related to the label of tickmarks and their relative positioning, color</span>
        <span class="c1"># of the tickmarks, and where they appear on the colorbar</span>
        <span class="n">cax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">cticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">mcticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cbar1</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">density</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">cbar_label</span> <span class="o">=</span> <span class="s2">&quot;Probability Density&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cbar_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$N$&quot;</span>

        <span class="n">cbar1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">clabelpad</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_thresh</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">[</span><span class="n">g_lim_1</span><span class="p">,</span> <span class="n">g_lim_2</span><span class="p">,</span> <span class="n">g_lim_3</span><span class="p">,</span> <span class="n">g_lim_4</span><span class="p">]:</span>
                <span class="n">g_lim_1</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">g_lim_2</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">g_lim_3</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">g_lim_4</span> <span class="o">=</span> <span class="mi">2</span>

            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dir_par</span><span class="p">,</span> <span class="n">dir_per</span><span class="p">]:</span>
                <span class="n">dir_par</span> <span class="o">=</span> <span class="s2">&quot;0.001_4.000_0.000_00.00&quot;</span>
                <span class="n">dir_per</span> <span class="o">=</span> <span class="s2">&quot;0.001_4.000_0.000&quot;</span>

            <span class="n">crv_b_1</span><span class="p">,</span> <span class="n">crv_r_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">(</span>
                <span class="s2">&quot;cycl&quot;</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">g_lim_1</span><span class="p">),</span> <span class="n">drct</span><span class="o">=</span><span class="n">dir_par</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">crv_b_1</span><span class="p">,</span> <span class="n">crv_r_1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cyclotron&quot;</span>
            <span class="p">)</span>

            <span class="n">crv_b_2</span><span class="p">,</span> <span class="n">crv_r_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">(</span>
                <span class="s2">&quot;fir1&quot;</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">g_lim_2</span><span class="p">),</span> <span class="n">drct</span><span class="o">=</span><span class="n">dir_par</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">crv_b_2</span><span class="p">,</span>
                <span class="n">crv_r_2</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;parallel firehose&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">crv_b_3</span><span class="p">,</span> <span class="n">crv_r_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">(</span>
                <span class="s2">&quot;mirr&quot;</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">g_lim_3</span><span class="p">),</span> <span class="n">drct</span><span class="o">=</span><span class="n">dir_per</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">crv_b_3</span><span class="p">,</span> <span class="n">crv_r_3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;mirror&quot;</span><span class="p">)</span>

            <span class="n">crv_b_4</span><span class="p">,</span> <span class="n">crv_r_4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh</span><span class="p">(</span>
                <span class="s2">&quot;fir2&quot;</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">g_lim_4</span><span class="p">),</span> <span class="n">drct</span><span class="o">=</span><span class="n">dir_per</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">crv_b_4</span><span class="p">,</span>
                <span class="n">crv_r_4</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
                <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;oblique firehose&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Set the label colors of legend label</span>
            <span class="n">labelcolor</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">]</span>
            <span class="n">legend_handles</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">legend_handles</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()):</span>
                <span class="n">text</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">labelcolor</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># Remove ther markers from legend</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">legend_handles</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">axs1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="mf">0.98</span><span class="p">,</span>
                <span class="mf">0.05</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;$\gamma/\Omega_</span><span class="se">{{</span><span class="s2">cp</span><span class="se">}}</span><span class="s2"> = 10^</span><span class="se">{{</span><span class="si">{</span><span class="o">-</span><span class="n">g_lim_1</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">axs1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_ver_thresh</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xmax</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
            <span class="c1"># rr = np.logspace(ymin, ymax, 100)</span>
            <span class="n">rr_cycl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rr</span><span class="p">(</span><span class="n">bb</span><span class="o">=</span><span class="n">bb</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=-</span><span class="n">g_lim_1</span><span class="p">,</span> <span class="n">instab</span><span class="o">=</span><span class="s2">&quot;cycl&quot;</span><span class="p">)</span>
            <span class="n">rr_mirr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rr</span><span class="p">(</span><span class="n">bb</span><span class="o">=</span><span class="n">bb</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=-</span><span class="n">g_lim_1</span><span class="p">,</span> <span class="n">instab</span><span class="o">=</span><span class="s2">&quot;mirr&quot;</span><span class="p">)</span>
            <span class="n">rr_fir1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rr</span><span class="p">(</span><span class="n">bb</span><span class="o">=</span><span class="n">bb</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=-</span><span class="n">g_lim_1</span><span class="p">,</span> <span class="n">instab</span><span class="o">=</span><span class="s2">&quot;fir1&quot;</span><span class="p">)</span>
            <span class="n">rr_fir2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rr</span><span class="p">(</span><span class="n">bb</span><span class="o">=</span><span class="n">bb</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=-</span><span class="n">g_lim_1</span><span class="p">,</span> <span class="n">instab</span><span class="o">=</span><span class="s2">&quot;fir2&quot;</span><span class="p">)</span>

            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">rr_cycl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cyclotron&quot;</span><span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">bb</span><span class="p">,</span>
                <span class="n">rr_fir1</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;parallel firehose&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">rr_mirr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;mirror&quot;</span><span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">bb</span><span class="p">,</span> <span class="n">rr_fir2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;oblique firehose&quot;</span>
            <span class="p">)</span>

            <span class="c1"># Set the label colors of legend label</span>
            <span class="n">labelcolor</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">]</span>
            <span class="n">legend_handles</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">legend_handles</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()):</span>
                <span class="n">text</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">labelcolor</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># Remove ther markers from legend</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">legend_handles</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">axs1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="mf">0.98</span><span class="p">,</span>
                <span class="mf">0.05</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;$\gamma/\Omega_</span><span class="se">{{</span><span class="s2">cp</span><span class="se">}}</span><span class="s2"> = 10^</span><span class="se">{{</span><span class="si">{</span><span class="o">-</span><span class="n">g_lim_1</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">axs1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">density</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figures/brazil_prob_</span><span class="si">{</span><span class="n">sim</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figures/brazil_</span><span class="si">{</span><span class="n">sim</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
            <span class="c1"># If the directory does not exist, create it</span>
            <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;figures&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                <span class="n">fig_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_show</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">n_hist</span><span class="p">)</span></div>


<div class="viewcode-block" id="hist_plots.get_brzl_hist">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.get_brzl_hist">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_brzl_hist</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">z</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">c_min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="c1"># Check to make sure all required values are passed. If not, raise an error.</span>
        <span class="c1"># NOTE: &#39;z = None&#39; produces standard bins of number of data</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;x data not provided&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y data not provided&quot;</span><span class="p">)</span>

        <span class="c1"># Change x, y, and z into numpy arrays</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c1"># Determine if 1 or 2 bin values are given and separate values if necessary.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="s2">&quot;len&quot;</span><span class="p">):</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">bins</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">bins</span>

        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>

        <span class="c1"># If no z data have been provided, generate a standard histogram.</span>
        <span class="c1"># Otherwise, manually generate bins and bin the data.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># NOTE: bins variables are lists of all leading edges plus the lagging edge of the final</span>
            <span class="c1"># bin.</span>
            <span class="n">xbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ybins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">hst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">])</span>

            <span class="c1"># Set all the bins with less than cmin to nan</span>
            <span class="n">hst</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">hst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">c_min</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="c1"># number of data points</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">hst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

            <span class="n">zplot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">hst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">zplot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">hst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># set number of data points to zero for running tally</span>
            <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># NOTE: bins variables are lists of all leading edges plus the lagging edge of the final</span>
            <span class="c1"># bin.</span>
            <span class="n">xbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ybins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c1"># For each bin, find all the z data whose corresponding x and y values fall within that</span>
            <span class="c1"># bin and save the medians as an array to be plotted.</span>
            <span class="n">zplot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">)])</span>
            <span class="n">zplot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">)])</span>

            <span class="n">tkx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># For each bin along the x-axis...</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
                <span class="c1"># find the x data with beta values within that bin</span>
                <span class="n">tkx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xbins</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">xbins</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># If no valid beta values were found, move to the next bin.</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tkx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># For each bin along the y-axis...</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">):</span>
                    <span class="c1"># find the y data with anisotropy values within that bin.</span>
                    <span class="n">tkxy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="n">tkx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">ybins</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">tkx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ybins</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="c1"># If any valid data were found, take the median of those data (ignoring &#39;Nan&#39;s)</span>
                    <span class="c1"># and assign that value to the corresponding location in &#39;zplot&#39; for plotting.</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tkxy</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">c_min</span><span class="p">:</span>
                        <span class="n">zplot1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">tkx</span><span class="p">][</span><span class="n">tkxy</span><span class="p">])</span>
                        <span class="n">zplot2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">tkx</span><span class="p">][</span><span class="n">tkxy</span><span class="p">])</span>
                        <span class="c1"># running tally of number of data points</span>
                        <span class="n">N</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">tkx</span><span class="p">][</span><span class="n">tkxy</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">zplot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">zplot1</span><span class="p">)</span>
            <span class="n">zplot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">zplot2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">xbins</span><span class="p">,</span> <span class="n">ybins</span><span class="p">,</span> <span class="n">zplot1</span><span class="p">,</span> <span class="n">zplot2</span></div>


<div class="viewcode-block" id="hist_plots.brazil_plot_multiple">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.brazil_plot_multiple">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">brazil_plot_multiple</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ymin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nbins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">spc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="c1"># TODO:L Add docstring</span>
        <span class="c1"># TODO: Modify the code for better readability and understandability.</span>

        <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.02</span>
        <span class="n">clabelpad</span> <span class="o">=</span> <span class="mf">5.0</span>
        <span class="n">labelsize</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="n">ticklabelsize</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="n">clabelsize</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">ticklength</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">mticklength</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">tickwidth</span> <span class="o">=</span> <span class="mf">1.5</span>
        <span class="n">tick_width</span> <span class="o">=</span> <span class="mf">1.5</span>
        <span class="n">ctick_length</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">labelrotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span>

        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nbins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbins</span> <span class="o">=</span> <span class="mi">50</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xmax</span><span class="p">),</span> <span class="n">nbins</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ymin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ymax</span><span class="p">),</span> <span class="n">nbins</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span>

        <span class="k">if</span> <span class="n">cmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmin</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">cmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmax</span> <span class="o">=</span> <span class="mf">1e2</span>

        <span class="k">if</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
            <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="n">axs_xlabel</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$\beta_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">} = 2 \mu_0 n_\mathrm</span><span class="si">{p}</span><span class="s2"> k_\mathrm</span><span class="si">{B}</span><span class="s2">$&quot;</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$T_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">}/B^2$&quot;</span>
        <span class="p">)</span>

        <span class="n">axs_ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$R_{\mathrm</span><span class="si">{p}</span><span class="s2">} = T_{\perp \mathrm</span><span class="si">{p}</span><span class="s2">}/T_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">}$&quot;</span>

        <span class="n">cbar_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\tilde</span><span class="si">{p}</span><span class="s2">( \beta_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">}, R_\mathrm</span><span class="si">{p}</span><span class="s2">) = n/( N \Delta \beta_{\parallel \mathrm</span><span class="si">{p}</span><span class="s2">} \Delta R_\mathrm</span><span class="si">{p}</span><span class="s2"> )$&quot;</span>

        <span class="c1"># Figure 1</span>
        <span class="n">axs1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">im1</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
        <span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axs_xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">axs_ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

        <span class="n">im1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">im1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">mticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">divider1</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs1</span><span class="p">)</span>
        <span class="n">cax1</span> <span class="o">=</span> <span class="n">divider1</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">cbar1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">im1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="n">cbar1</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tick_width</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ctick_length</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cbar1</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
        <span class="n">cbar1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$N$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">clabelpad</span><span class="p">)</span>

        <span class="c1"># Figure 2</span>
        <span class="n">axs2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">im2</span> <span class="o">=</span> <span class="n">axs2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">ex</span><span class="p">,</span>
            <span class="n">ey</span><span class="p">,</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
            <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">8e-5</span><span class="p">,</span> <span class="mf">6e-1</span><span class="p">),</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">axs2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axs_xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>

        <span class="n">axs2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">axs2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">axs2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

        <span class="n">im2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">im2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">mticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">divider2</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs2</span><span class="p">)</span>
        <span class="n">cax2</span> <span class="o">=</span> <span class="n">divider2</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">cbar2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">im2</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="n">cbar2</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tick_width</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ctick_length</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cbar2</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
        <span class="n">cbar2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$\Gamma_{\max}/\Omega_{\rm cp}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">clabelpad</span>
        <span class="p">)</span>

        <span class="c1"># Figure 3</span>
        <span class="n">axs3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axs1</span><span class="p">)</span>

        <span class="n">im3</span> <span class="o">=</span> <span class="n">axs3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">ex</span><span class="p">,</span>
            <span class="n">ey</span><span class="p">,</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
            <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">axs3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axs_xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>

        <span class="n">axs3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">axs3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">axs3</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs3</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

        <span class="n">im3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">im3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">mticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">divider3</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs3</span><span class="p">)</span>
        <span class="n">cax3</span> <span class="o">=</span> <span class="n">divider3</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">cbar3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">im3</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax3</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="n">cbar3</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tick_width</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ctick_length</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cbar3</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

        <span class="n">cbar3</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$\omega_{\rm nl}/\Omega_{\rm cp}$&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">labelpad</span><span class="o">=</span><span class="n">clabelpad</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Figure 4</span>
        <span class="n">axs4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">im4</span> <span class="o">=</span> <span class="n">axs4</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">ex</span><span class="p">,</span>
            <span class="n">ey</span><span class="p">,</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
            <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">),</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bwr</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">axs4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axs_xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>

        <span class="n">axs4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">axs4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">axs4</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs4</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

        <span class="n">im4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">im4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tickwidth</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">mticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="n">labelrotation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">divider4</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs4</span><span class="p">)</span>
        <span class="n">cax4</span> <span class="o">=</span> <span class="n">divider4</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">cbar4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">im4</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax4</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="n">cbar4</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">tick_width</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ctick_length</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cbar4</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

        <span class="n">cbar4</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$\Gamma_{\max}/\omega_{\rm nl}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">clabelpad</span>
        <span class="p">)</span>

        <span class="n">xticks2</span> <span class="o">=</span> <span class="n">im2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">()</span>
        <span class="n">xticks2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">xticks2</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">xticks3</span> <span class="o">=</span> <span class="n">im3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">()</span>
        <span class="n">xticks3</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># yticks1 = axs1.xaxis.get_minor_ticks()</span>
        <span class="c1"># yticks1[-1].set_visible(False)</span>

        <span class="c1"># xticks2 = axs2.xaxis.get_major_ticks()</span>
        <span class="c1"># xticks2[0].set_visible(False)</span>

        <span class="c1"># xticks3 = axs3.xaxis.get_major_ticks()</span>
        <span class="c1"># xticks3[0].set_visible(False)</span>

        <span class="c1"># xticks4 = axs4.xaxis.get_major_ticks()</span>
        <span class="c1"># xticks4[0].set_visible(False)</span>

        <span class="c1"># yticks4 = axs1.xaxis.get_major_ticks()</span>
        <span class="c1"># yticks4[-1].set_visible(False)</span>

        <span class="c1"># cxticks2 = cax2.xaxis.get_major_ticks()</span>
        <span class="c1"># cxticks2[0].set_visible(False)</span>

        <span class="n">cxticks3</span> <span class="o">=</span> <span class="n">cax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">()</span>
        <span class="n">cxticks3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># cxticks4 = cax4.xaxis.get_major_ticks()</span>
        <span class="c1"># cxticks4[0].set_visible(False)</span>

        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="n">fig_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figures/</span><span class="si">{</span><span class="n">spc</span><span class="si">}</span><span class="s2">_brz_omega_gamma_mean.pdf&quot;</span>
            <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;figures&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                <span class="n">fig_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>
            <span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure saved for spacecraft </span><span class="si">{</span><span class="n">spc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="hist_plots.calc_pdf">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.calc_pdf">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_pdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
        <span class="n">weight</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">inc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">Normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_pdf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fig_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the probability density function of a given array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_array : np.array</span>
<span class="sd">            The array for which the pdf is to be calculated</span>
<span class="sd">        weight : int, optional</span>
<span class="sd">            The number of points in each bin, by default 100</span>
<span class="sd">        inc : int, optional</span>
<span class="sd">            The number of points to be shifted, by default None</span>
<span class="sd">        Normalize : bool, optional</span>
<span class="sd">            Normalize the input array by the rms value, by default False</span>
<span class="sd">        plot_pdf : bool, optional</span>
<span class="sd">            Plot the pdf, by default False</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            Save the figure, by default False</span>
<span class="sd">        fig_name : str, optional</span>
<span class="sd">            The name of the figure, by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            The bins of the pdf</span>
<span class="sd">        np.array</span>
<span class="sd">            The pdf of the input array</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from arcanum.histogram_plots import hist_plots</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.rand(100000)</span>
<span class="sd">        &gt;&gt;&gt; bins, x_pdf = hist_plots().calc_pdf(input_array=x, inc=5000, Normalize=False, weight=100, plot_pdf=True, save_fig=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check is the array is to be shifted</span>
        <span class="k">if</span> <span class="n">inc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Find the difference between elements in the array separated by inc</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">input_array</span><span class="p">[</span><span class="n">inc</span><span class="p">:]</span> <span class="o">-</span> <span class="n">input_array</span><span class="p">[:</span><span class="o">-</span><span class="n">inc</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">input_array</span>

        <span class="k">if</span> <span class="n">Normalize</span><span class="p">:</span>
            <span class="n">rmsval</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">series</span> <span class="o">/</span> <span class="n">rmsval</span>

        <span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">series</span><span class="p">)]</span>
        <span class="c1"># Sort the series</span>
        <span class="n">series</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span> <span class="o">/</span> <span class="n">weight</span><span class="p">)</span>

        <span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

        <span class="c1"># For each bin, take the size, divide by the max-min of that bin, then add to pdf</span>
        <span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">),</span> <span class="n">weight</span><span class="p">):</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">weight</span> <span class="p">:</span> <span class="n">i</span><span class="p">]</span>
            <span class="n">bins</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">pdf</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">/</span> <span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="n">acc</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">plot_pdf</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bins&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PDF&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fig_name</span> <span class="o">=</span> <span class="s2">&quot;pdf.png&quot;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bins</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span></div>


<div class="viewcode-block" id="hist_plots.joint_pdf">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.joint_pdf">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">joint_pdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">x_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">y_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">save_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fig_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">joint_pdf_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">imshow_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the joint probability density function of two given arrays</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.array</span>
<span class="sd">            The first array for which the pdf is to be calculated</span>
<span class="sd">        y : np.array</span>
<span class="sd">            The second array for which the pdf is to be calculated</span>
<span class="sd">        bins : int, optional</span>
<span class="sd">            The number of bins in the histogram, by default 100</span>
<span class="sd">        x_label : str, optional</span>
<span class="sd">            The label of the x-axis, by default None</span>
<span class="sd">        y_label : str, optional</span>
<span class="sd">            The label of the y-axis, by default None</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            Save the figure, by default False</span>
<span class="sd">        fig_name : str, optional</span>
<span class="sd">            The name of the figure, by default None</span>
<span class="sd">        joint_pdf_kwargs : dict, optional</span>
<span class="sd">            Additional arguments to be passed to the joint pdf plot, by default None. These keyword arguments are passed to the plt.hist2d function</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            The histogram of the joint pdf</span>
<span class="sd">        np.array</span>
<span class="sd">            The x data</span>
<span class="sd">        np.array</span>
<span class="sd">            The y data</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from arcanum.histogram_plots import hist_plots</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.lognormal(mean=0, sigma=2, size=100000)</span>
<span class="sd">        &gt;&gt;&gt; x = np.clip(x, 1e-3, 1e2)</span>
<span class="sd">        &gt;&gt;&gt; y = np.random.lognormal(mean=0, sigma=2, size=100000)</span>
<span class="sd">        &gt;&gt;&gt; y = np.clip(y, 1e-3, 1e2)</span>
<span class="sd">        &gt;&gt;&gt; hst, x_s, y_s = hist_plots().joint_pdf(x=x, y=y, bins=100, save_fig=True, joint_pdf_kwargs={ &quot;bins&quot;: 1000, &quot;cmap&quot;: &quot;cividis_r&quot;,&quot;norm&quot;: &quot;log&quot;,}, imshow_kwargs={</span>
<span class="sd">        &quot;cmap&quot;: &quot;Spectral&quot;, &quot;norm&quot;: &quot;log&quot;, &quot;origin&quot;: &quot;lower&quot;,},)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;x data not provided&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y data not provided&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">x_s</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y_s</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">x_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">x_s</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">y_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">y_s</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># Plotting the histogram</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="n">fig1</span><span class="p">,</span> <span class="n">axs1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">hst</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span>
            <span class="n">x_s</span><span class="p">,</span>
            <span class="n">y_s</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">x_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">x_s</span><span class="p">)],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">y_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">y_s</span><span class="p">)]],</span>
            <span class="o">**</span><span class="p">(</span><span class="n">joint_pdf_kwargs</span> <span class="k">if</span> <span class="n">joint_pdf_kwargs</span> <span class="k">else</span> <span class="p">{}),</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

        <span class="c1"># Plotting the surface contour</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>

        <span class="n">fig2</span><span class="p">,</span> <span class="n">axs2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># cs = axs2.contourf( X, Y, np.transpose( hst[0] ), levels=25, norm=mpl.colors.LogNorm(),cmap=plt.cm.jet, origin=&#39;lower&#39; )</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">axs2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">hst</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">x_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">x_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">y_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">y_s</span><span class="p">)],</span>
            <span class="c1"># norm=mpl.colors.LogNorm(),</span>
            <span class="c1"># cmap=plt.cm.Spectral,</span>
            <span class="c1"># origin=&quot;lower&quot;,</span>
            <span class="o">**</span><span class="p">(</span><span class="n">imshow_kwargs</span> <span class="k">if</span> <span class="n">imshow_kwargs</span> <span class="k">else</span> <span class="p">{}),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axs2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joint PDF between </span><span class="si">{</span><span class="n">x_label</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">y_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs2</span><span class="p">)</span>

        <span class="c1"># Define the location of the colorbar, it&#39;s size relative to main figure</span>
        <span class="c1"># and the padding between the colorbar and the figure, the orientation</span>
        <span class="c1"># the colorbar</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;10%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">cs</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>

        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Define the parameters related to the label of tickmarks and their relative</span>
        <span class="c1"># positioning, color of the tickmarks, and where they appear on the colorbar</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="s2">&quot;figures/joint_pdf.png&quot;</span>
                <span class="c1"># If the directory does not exist, create it</span>
            <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;figures&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                <span class="n">fig_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">hst</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span></div>


<div class="viewcode-block" id="hist_plots.kde_plots">
<a class="viewcode-back" href="../../rst_files/arcanum.histogram_plots.html#arcanum.histogram_plots.hist_plots.kde_plots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">kde_plots</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">y_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">x_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">y_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">save_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fig_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sea_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The code to plot the kernel density estimate plot for any kind of data. The scale of both x-</span>
<span class="sd">        and y-axes is &quot;linear&quot;, this can be changed in the line which 65 or so where &quot;bins&quot; is</span>
<span class="sd">        defined and setting both scales of x- and y-axes to log instead of linear.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_data : np.array</span>
<span class="sd">            The x data for the kde plot</span>
<span class="sd">        y_data : np.array</span>
<span class="sd">            The y data for the kde plot</span>
<span class="sd">        x_label : str</span>
<span class="sd">            The label for the x-axis</span>
<span class="sd">        y_label : str</span>
<span class="sd">            The label for the y-axis</span>
<span class="sd">        save_fig : bool</span>
<span class="sd">            Whether to save the figure or not</span>
<span class="sd">        sea_kwargs : dict</span>
<span class="sd">            Additional arguments to be passed to the seaborn jointplot function. These keyword</span>
<span class="sd">            arguments are passed to the sns.jointplot function in the seaborn library</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sns.axisgrid.JointGrid</span>
<span class="sd">            The seaborn jointplot object</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from arcanum.histogram_plots import hist_plots</span>
<span class="sd">        &gt;&gt;&gt; x = np.random.lognormal(mean=0, sigma=2, size=10000)</span>
<span class="sd">        &gt;&gt;&gt; x = np.clip(x, 1e-3, 1e2)</span>
<span class="sd">        &gt;&gt;&gt; y = np.random.lognormal(mean=0, sigma=2, size=10000)</span>
<span class="sd">        &gt;&gt;&gt; y = np.clip(y, 1e-1, 1e1)</span>
<span class="sd">        &gt;&gt;&gt; hist_plots().kde_plots(x_data=x, y_data=y, save_fig=True, sea_kwargs={ &quot;kind&quot;: &quot;kde&quot;, &quot;cbar&quot;: True, &quot;thresh&quot;: 0.05, &quot;fill&quot;: True, &quot;levels&quot;: 10, &quot;log_scale&quot;: True, &quot;hue_norm&quot;: &quot;log&quot;, &quot;cmap&quot;: &quot;Blues&quot;, &quot;height&quot;: 6, &quot;ratio&quot;: 8, &quot;space&quot;: 0.01, &quot;xlim&quot;: (1e-3, 1e2), &quot;ylim&quot;: (1e-3, 1e2), },</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check if Seaborn is installed, if not then raise an error and return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;Seaborn is not installed, please install it using pip install seaborn&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="n">labelsize</span> <span class="o">=</span> <span class="mi">28</span>
        <span class="n">ticklabelsize</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">clabelsize</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">ticklength</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="n">axs1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_data</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_data</span><span class="p">,</span>
            <span class="o">**</span><span class="p">(</span><span class="n">sea_kwargs</span> <span class="k">if</span> <span class="n">sea_kwargs</span> <span class="k">else</span> <span class="p">{}),</span>
        <span class="p">)</span>

        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">lims</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)]</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span> <span class="n">lims</span><span class="p">,</span> <span class="s2">&quot;--r&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">pos_joint_ax</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">pos_marg_x_ax</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span>
            <span class="p">[</span><span class="n">pos_joint_ax</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">pos_joint_ax</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">pos_marg_x_ax</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pos_joint_ax</span><span class="o">.</span><span class="n">height</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos_joint_ax</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="n">pos_joint_ax</span><span class="o">.</span><span class="n">height</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># get the current colorbar ticks</span>
        <span class="n">cbar_ticks</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
        <span class="c1"># get the maximum value of the colorbar</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">cbar_max</span> <span class="o">=</span> <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="c1"># change the labels (not the ticks themselves) to a percentage</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">cbar_max</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cbar_ticks</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">clabelsize</span>
        <span class="p">)</span>

        <span class="c1"># Set the x-label at the center of the colorbar</span>
        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span>
            <span class="mf">0.5</span><span class="p">,</span>
            <span class="s2">&quot;Density [%]&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
            <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
            <span class="n">labelsize</span><span class="o">=</span><span class="n">ticklabelsize</span><span class="p">,</span>
            <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
                <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
                <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
                <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
                <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">length</span><span class="o">=</span><span class="n">ticklength</span><span class="p">,</span>
                <span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">,</span>
                <span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">axs1</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="s2">&quot;figures/kdeplot.pdf&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figures/</span><span class="si">{</span><span class="n">fig_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="c1"># If the directory does not exist, create it</span>
            <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;figures&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">axs1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axs1</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright @ Ramiz Qudsi, 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>